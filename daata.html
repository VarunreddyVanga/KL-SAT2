<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Sheets Data Display</title>
</head>
<body>

<table border="1">
  <tbody id="data-body">
    <!-- Data will be displayed here -->
  </tbody>
</table>

<script>
  document.addEventListener('DOMContentLoaded', fetchData);
  setInterval(fetchData, 80000); // Fetch data every 5 seconds

  async function fetchData() {
    const url = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRLRnCBrA9vF7iBYoYy5auhrtM2f2xBuLngC9e9gd8uquoAdDO6W2b3eOuYBwTGLU0DkrfZIweQ4NDK/pub?output=csv";

    try {
      const response = await fetch(url);
      const data = await response.text();
      const rows = data.split('\n');

      const tbody = document.getElementById('data-body');
      tbody.innerHTML = "";

      rows.forEach(row => {
        const columns = row.split(',');
        const tr = document.createElement('tr');

        columns.forEach(column => {
          const td = document.createElement('td');
          td.textContent = column;
          tr.appendChild(td);
        });

        tbody.appendChild(tr);
      });

    } catch (error) {
      console.error('Error fetching data:', error);
    }
  }
</script>

</body>
</html>
